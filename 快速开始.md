# åç«¯å¿«é€Ÿå¼€å§‹æŒ‡å—

## å‡†å¤‡å·¥ä½œ

### 1. è·å–API Key

#### é€šä¹‰åƒé—®API Keyï¼ˆç”¨äºè¡Œç¨‹è§„åˆ’ï¼‰

1. è®¿é—® https://dashscope.aliyuncs.com/
2. ä½¿ç”¨é˜¿é‡Œäº‘è´¦å·ç™»å½•ï¼ˆæ²¡æœ‰çš„è¯éœ€è¦æ³¨å†Œï¼‰
3. è¿›å…¥æ§åˆ¶å°ï¼Œæ‰¾åˆ°"API Keyç®¡ç†"
4. åˆ›å»ºæ–°çš„API Keyï¼ˆå…è´¹ç”¨æˆ·æœ‰ä¸€å®šé¢åº¦ï¼‰
5. å¤åˆ¶API Keyï¼ˆæ ¼å¼ï¼š`sk-xxxxxxxxxx`ï¼‰

#### ç«å±±å¼•æ“è±†åŒ…API Keyï¼ˆç”¨äºèœå“è¯†åˆ«å’Œåˆ†æï¼Œå¯é€‰ï¼‰

1. è®¿é—® https://console.volcengine.com/
2. æ³¨å†Œ/ç™»å½•è´¦å·
3. å¼€é€šè±†åŒ…AIæœåŠ¡
4. è·å–API Key

### 2. é…ç½®æ•°æ®åº“ï¼ˆå¿…éœ€ï¼‰

#### å®‰è£…MySQL

**Windows:**
- ä¸‹è½½ï¼šhttps://dev.mysql.com/downloads/mysql/
- æˆ–ä½¿ç”¨XAMPPï¼šhttps://www.apachefriends.org/

**macOS:**
```bash
brew install mysql
brew services start mysql
```

**Linux (Ubuntu):**
```bash
sudo apt update
sudo apt install mysql-server
sudo systemctl start mysql
```

#### åˆ›å»ºæ•°æ®åº“

```sql
-- ç™»å½•MySQL
mysql -u root -p

-- åˆ›å»ºæ•°æ®åº“
CREATE DATABASE lifehub CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

### 3. é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `.env` æ–‡ä»¶ï¼ˆåœ¨backendç›®å½•ä¸‹ï¼‰ï¼š

```bash
# Windowså‘½ä»¤
copy env_example.txt .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œå¡«å…¥é…ç½®ï¼š

```env
# AIæœåŠ¡é…ç½®
DASHSCOPE_API_KEY=sk-ä½ çš„é€šä¹‰åƒé—®API_Key
VOLC_ACCESS_KEY=ä½ çš„ç«å±±å¼•æ“AccessKeyï¼ˆå¯é€‰ï¼‰
VOLC_SECRET_KEY=ä½ çš„ç«å±±å¼•æ“SecretKeyï¼ˆå¯é€‰ï¼‰

# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=ä½ çš„æ•°æ®åº“å¯†ç 
DB_NAME=lifehub

# æœåŠ¡å™¨é…ç½®
HOST=0.0.0.0
PORT=8000
```

## å¯åŠ¨æœåŠ¡

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ä¸€é”®å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# Windows
åŒå‡» start.bat

# æˆ–åœ¨å‘½ä»¤è¡Œè¿è¡Œ
start.bat
```

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨å¯åŠ¨

```bash
# 1. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# 2. æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# Windows
venv\Scripts\activate
# Linux/macOS
source venv/bin/activate

# 3. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 4. åˆå§‹åŒ–æ•°æ®åº“ï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
python utils/init_database.py

# 5. å¯åŠ¨æœåŠ¡
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

## éªŒè¯æœåŠ¡

æœåŠ¡å¯åŠ¨åï¼Œæ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š

### 1. APIæ–‡æ¡£ï¼ˆæ¨èï¼‰
http://localhost:8000/docs

åœ¨è¿™ä¸ªé¡µé¢å¯ä»¥ï¼š
- æŸ¥çœ‹æ‰€æœ‰APIæ¥å£
- ç›´æ¥æµ‹è¯•API
- æŸ¥çœ‹è¯·æ±‚/å“åº”æ ¼å¼

### 2. å¥åº·æ£€æŸ¥
http://localhost:8000/health

åº”è¯¥çœ‹åˆ°ï¼š
```json
{
  "status": "ok",
  "api_key_configured": true
}
```

å¦‚æœ `api_key_configured` ä¸º `false`ï¼Œè¯´æ˜API Keyæœªæ­£ç¡®é…ç½®ã€‚

## æµ‹è¯•API

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨Swagger UIï¼ˆæ¨èï¼‰

1. è®¿é—® http://localhost:8000/docs
2. å¯ä»¥æµ‹è¯•ä»¥ä¸‹æ¥å£ï¼š
   - `POST /api/user/register` - ç”¨æˆ·æ³¨å†Œ
   - `GET /api/user/data` - ç”¨æˆ·ç™»å½•
   - `POST /api/food/analyze` - åˆ†æèœå“è¥å…»
   - `POST /api/food/recognize` - è¯†åˆ«èœå•å›¾ç‰‡
   - `POST /api/food/record` - æ·»åŠ é¥®é£Ÿè®°å½•
   - `GET /api/food/records/today` - è·å–ä»Šæ—¥é¥®é£Ÿè®°å½•
   - `POST /api/trip/generate` - ç”Ÿæˆè¿åŠ¨è®¡åˆ’
   - `GET /api/user/preferences` - è·å–ç”¨æˆ·åå¥½
   - `GET /api/weather/by-address` - æŸ¥è¯¢å¤©æ°”

### æ–¹æ³•äºŒï¼šä½¿ç”¨æµ‹è¯•è„šæœ¬

```bash
# è¿è¡Œæµ‹è¯•è„šæœ¬
python test/test_user_api.py      # æµ‹è¯•ç”¨æˆ·API
python test/test_menu_recognize.py # æµ‹è¯•èœå•è¯†åˆ«
python test/test_trip_api.py       # æµ‹è¯•è¡Œç¨‹API
```

### æ–¹æ³•ä¸‰ï¼šä½¿ç”¨curl

```bash
# ç”¨æˆ·æ³¨å†Œ
curl -X POST http://localhost:8000/api/user/register \
  -H "Content-Type: application/json" \
  -d '{"nickname": "æµ‹è¯•ç”¨æˆ·", "password": "password123"}'

# ç”¨æˆ·ç™»å½•
curl "http://localhost:8000/api/user/data?nickname=æµ‹è¯•ç”¨æˆ·&password=password123"

# åˆ†æèœå“
curl -X POST http://localhost:8000/api/food/analyze \
  -H "Content-Type: application/json" \
  -d "{\"food_name\": \"ç•ªèŒ„ç‚’è›‹\"}"

# è·å–ä»Šæ—¥é¥®é£Ÿè®°å½•
curl "http://localhost:8000/api/food/records/today?userId=1"

# ç”Ÿæˆè¿åŠ¨è®¡åˆ’
curl -X POST http://localhost:8000/api/trip/generate \
  -H "Content-Type: application/json" \
  -d "{\"userId\": 1, \"query\": \"ä»Šå¤©åˆé¤åå®‰æ’æ•£æ­¥ï¼Œæ¶ˆè€—200åƒå¡\"}"

# æŸ¥è¯¢å¤©æ°”
curl "http://localhost:8000/api/weather/by-address?address=åŒ—äº¬å¸‚æœé˜³åŒº"
```

## è¿æ¥Android

### ä½¿ç”¨æ¨¡æ‹Ÿå™¨

Androidæ¨¡æ‹Ÿå™¨ä¸­ï¼Œä½¿ç”¨ç‰¹æ®ŠIPï¼š

```kotlin
const val BASE_URL = "http://10.0.2.2:8000"
```

### ä½¿ç”¨çœŸæœº

1. æŸ¥çœ‹ç”µè„‘IPåœ°å€ï¼š
   ```bash
   ipconfig
   ```
   æ‰¾åˆ° "æ— çº¿å±€åŸŸç½‘é€‚é…å™¨ WLAN" çš„ IPv4 åœ°å€ï¼Œä¾‹å¦‚ï¼š`192.168.1.100`

2. ç¡®ä¿æ‰‹æœºå’Œç”µè„‘åœ¨åŒä¸€WiFiç½‘ç»œ

3. Androidä»£ç ä¸­ä½¿ç”¨ç”µè„‘IPï¼š
   ```kotlin
   const val BASE_URL = "http://192.168.1.100:8000"
   ```

4. å¦‚æœè¿æ¥å¤±è´¥ï¼Œæ£€æŸ¥Windowsé˜²ç«å¢™æ˜¯å¦é˜»æ­¢äº†8000ç«¯å£

## å¸¸è§é—®é¢˜

### 1. ç«¯å£è¢«å ç”¨

**é”™è¯¯ä¿¡æ¯ï¼š**
```
[Errno 10048] error while attempting to bind on address
```

**è§£å†³æ–¹æ³•ï¼š**
```bash
# æ›´æ¢ç«¯å£
uvicorn app.main:app --reload --port 8001
```

### 2. API Keyæœªè®¾ç½®

**é”™è¯¯ä¿¡æ¯ï¼š**
```
æœåŠ¡é…ç½®é”™è¯¯: æœªè®¾ç½®DASHSCOPE_API_KEYç¯å¢ƒå˜é‡
```

**è§£å†³æ–¹æ³•ï¼š**
1. ç¡®è®¤å·²åˆ›å»º `.env` æ–‡ä»¶
2. ç¡®è®¤API Keyæ­£ç¡®å¤åˆ¶
3. é‡å¯æœåŠ¡

### 3. ä¾èµ–å®‰è£…å¤±è´¥

**è§£å†³æ–¹æ³•ï¼š**
```bash
# å‡çº§pip
python -m pip install --upgrade pip

# ä½¿ç”¨å›½å†…é•œåƒæº
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### 4. è™šæ‹Ÿç¯å¢ƒæ¿€æ´»å¤±è´¥

**Windows PowerShellé”™è¯¯ï¼š**
```
æ— æ³•åŠ è½½æ–‡ä»¶ï¼Œå› ä¸ºåœ¨æ­¤ç³»ç»Ÿä¸Šç¦æ­¢è¿è¡Œè„šæœ¬
```

**è§£å†³æ–¹æ³•ï¼š**
```powershell
# ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡ŒPowerShell
Set-ExecutionPolicy RemoteSigned

# æˆ–ä½¿ç”¨cmdè€Œä¸æ˜¯PowerShell
```

### 5. çœŸæœºæ— æ³•è¿æ¥

**è§£å†³æ–¹æ³•ï¼š**
1. ç¡®è®¤æ‰‹æœºå’Œç”µè„‘åœ¨åŒä¸€WiFi
2. åœ¨Windowsé˜²ç«å¢™ä¸­å…è®¸Pythoné€šè¿‡ï¼š
   - æ§åˆ¶é¢æ¿ â†’ Windows Defender é˜²ç«å¢™ â†’ å…è®¸åº”ç”¨é€šè¿‡é˜²ç«å¢™
   - æ‰¾åˆ°Pythonï¼Œå‹¾é€‰"ä¸“ç”¨"å’Œ"å…¬ç”¨"
3. æˆ–ä¸´æ—¶å…³é—­é˜²ç«å¢™æµ‹è¯•

## æŸ¥çœ‹æ—¥å¿—

æœåŠ¡è¿è¡Œæ—¶ä¼šåœ¨ç»ˆç«¯æ˜¾ç¤ºæ—¥å¿—ï¼š

```
INFO:     Started server process [12345]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000
```

APIè°ƒç”¨æ—¶ä¹Ÿä¼šæ˜¾ç¤ºï¼š
```
INFO:     127.0.0.1:52341 - "POST /api/food/analyze HTTP/1.1" 200 OK
```

## æˆåŠŸæ ‡å¿—

### 1. æœåŠ¡å¯åŠ¨æˆåŠŸ

å¯åŠ¨ååº”è¯¥çœ‹åˆ°ï¼š
```
ğŸš€ åº”ç”¨å¯åŠ¨ä¸­...
âœ… æ•°æ®åº“è¿æ¥æ­£å¸¸
INFO:     Uvicorn running on http://0.0.0.0:8000
```

### 2. å¥åº·æ£€æŸ¥é€šè¿‡

è®¿é—® http://localhost:8000/healthï¼Œåº”è¯¥çœ‹åˆ°ï¼š
```json
{
  "status": "ok",
  "api_key_configured": true
}
```

### 3. APIæµ‹è¯•æˆåŠŸ

æµ‹è¯•èœå“åˆ†ææ¥å£ï¼Œåº”è¯¥è¿”å›ï¼š
```json
{
  "success": true,
  "message": "åˆ†ææˆåŠŸ",
  "data": {
    "name": "ç•ªèŒ„ç‚’è›‹",
    "calories": 150.0,
    "protein": 10.5,
    "fat": 8.2,
    "carbs": 6.3,
    "recommendation": "è¿™é“èœè¥å…»å‡è¡¡ï¼Œè›‹ç™½è´¨å«é‡è¾ƒé«˜ï¼Œé€‚åˆå‡è„‚æœŸé£Ÿç”¨ã€‚å»ºè®®æ§åˆ¶æ²¹é‡ã€‚"
  }
}
```

## æ ¸å¿ƒåŠŸèƒ½

### 1. é¤é¥®æœåŠ¡
- âœ… èœå“è¥å…»åˆ†æ
- âœ… èœå•å›¾ç‰‡è¯†åˆ«
- âœ… é¥®é£Ÿè®°å½•ç®¡ç†
- âœ… ä»Šæ—¥é¥®é£Ÿç»Ÿè®¡

### 2. è¿åŠ¨è®¡åˆ’
- âœ… AIç”Ÿæˆé¤åè¿åŠ¨è®¡åˆ’
- âœ… è¡Œç¨‹åˆ—è¡¨ç®¡ç†
- âœ… è¡Œç¨‹è¯¦æƒ…æŸ¥çœ‹

### 3. ç”¨æˆ·ä¸­å¿ƒ
- âœ… ç”¨æˆ·æ³¨å†Œ
- âœ… ç”¨æˆ·ç™»å½•
- âœ… ç”¨æˆ·åå¥½è®¾ç½®
- âœ… å¥åº·ç›®æ ‡ç®¡ç†
- âœ… è¿‡æ•åŸè®¾ç½®

### 4. å¤©æ°”æœåŠ¡
- âœ… æ ¹æ®åœ°å€æŸ¥è¯¢å¤©æ°”
- âœ… æ ¹æ®è¡Œç¨‹è®¡åˆ’æŸ¥è¯¢å¤©æ°”
- âœ… ä½¿ç”¨Open-Meteoï¼ˆæ— éœ€API Keyï¼‰

## éœ€è¦å¸®åŠ©ï¼Ÿ

- æŸ¥çœ‹ `README.md` äº†è§£æ›´å¤šè¯¦æƒ…
- æŸ¥çœ‹ç»ˆç«¯æ—¥å¿—æ‰¾å‡ºé”™è¯¯åŸå› 
- ç¡®ä¿Pythonç‰ˆæœ¬ â‰¥ 3.10

